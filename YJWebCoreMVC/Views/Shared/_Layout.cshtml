@*
    * Phanindra 09/13/2024 Added input field to store WebImagesUrl
    * Neetha     10/11/2024 Added new div for Modal inside a form
    * Hemanth    10/16/2024 Added new modal for invoice search
    * Phanindra  10/22/2024 Added 2 models for common uses and added session UserId input
    * Phanindra  11/07/2024 Added StoreCodeInUse input for common use.
    * Phanindra  12/23/2024 Worked on changing menu design to top.
    * Hemanth    01/01/2025 empty div added
    * Phanindra  01/03/2025 Worked on third level menu related change
    * Hemanth    01/27/2025 Appraisal modal added
    * Mandeep    02/26/2025 Changes for invoice
    * Phanindra  03/04/2025 Fixed issue with duplicate js and css files.
    * Hemanth    03/10/2025 Items Not Previously Returned added
    * Mandeep    05/21/2025
    * Phanindra  05/22/2025 Fixed the dropdown issue (visibility issue) in menu
    * Hemanth    06/02/2025 canvas js version update
    * Phanindra  06/04/2025 Removed extra character which someone kept by mistake in htmlcanvas method.
    * Phanindra  06/12/2025 fixed issue with menu jerk
    * Hemanth    06/17/2025 selectRepairModal modal added
    * Hemanth    06/25/2025 selectProformaInvoic modal added
    * Hemanth    07/18/2025 selectPOModal modal added
    * Neetha     07/29/2025 Added 4 new checkboxes in invoice search popup.
    * Phanindra  09/17/2025 Added new loader to use in ajax calls
    * Hemanth    07/18/2025 userAccount hidden field added for user type
    * Phanindra  10/29/2025 Added bootstrap link for icons
    * Phanindra  11/10/2025 Added version in the footer.
    * Phanindra  12/02/2025 Added jquery.dataTables.min.css file to local.
    * venkat     12/16/2025 Added globalMsgModal and its css
    * mandeep    12/31/2025 updated js and fixes for modals
    * venkat     12/31/2025 Added salesChartModal and refresh-btn
*@

@{
    Layout = null;
}

@using System.Reflection

@{
    var version = Assembly.GetExecutingAssembly()
    .GetCustomAttribute<AssemblyInformationalVersionAttribute>()?
    .InformationalVersion;
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- link css -->
    <link rel="stylesheet" href="~/css/style.css">
    <link rel="stylesheet" href="~/css/font-awesome.min.css">
    <link rel="stylesheet" href="~/css/themify-icons.css">
    <link rel="stylesheet" href="~/css/line-icons.css">
    <link rel="stylesheet" href="~/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/css/animate.min.css">
    <link rel="stylesheet" href="~/css/owl.carousel.css">
    <link rel="stylesheet" href="~/css/color.css">
    <link rel="stylesheet" href="~/css/responsive.css">
    <link rel="stylesheet" href="~/css/scanAccordion.css">
    <link rel="stylesheet" type="text/css" href="~/css/jquery.dataTables.min.css">
    @*<link rel="stylesheet" href="~/css/theme.css">*@
    <!-- Ensure jQuery UI is loaded (remove duplicates from _Layout.cshtml if necessary) -->
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script src="~/js/refresh-button.js"></script>
    <style>
        /* ===============================
                        GLOBAL MESSAGE MODAL
                ================================*/
        /* Popup width + center */
        #globalMsgModal .modal-dialog {
            max-width: 420px !important;
            margin: 80px auto !important;
        }
        /* Outer panel */
        #globalMsgModal .modal-content {
            border-radius: 12px !important;
            box-shadow: 0 6px 25px rgba(0,0,0,0.30) !important;
            overflow: hidden;
        }
        /* Header — Professional look */
        #globalMsgModal .modal-header {
            background: #0d47a1 !important; /* ⭐ Recommended Royal Blue */
            color: #fff !important;
            padding: 12px 18px !important;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #globalMsgModal .modal-title {
            font-size: 17px;
            font-weight: 600;
            margin: 0;
        }
        /* Close (X) button styling */
        #globalMsgModal .close {
            font-size: 20px !important;
            color: #fff !important;
            opacity: 0.9 !important;
        }

            #globalMsgModal .close:hover {
                opacity: 1 !important;
            }
        /* Body text */
        #globalMsgModal .modal-body {
            padding: 20px !important;
            font-size: 15px;
            color: #333;
        }
        /* Footer alignment */
        #globalMsgModal .modal-footer {
            justify-content: center !important;
            background: #f7f7f7 !important;
            padding: 12px !important;
        }
        /* OK button style */
        #globalMsgModal .btn-primary {
            padding: 6px 25px !important;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
        }
        /* Ensure popup above everything */
        #globalMsgModal {
            z-index: 999999 !important;
        }
        /* Backdrop dimming */
        .modal-backdrop.show {
            opacity: 0.45 !important;
        }
        /* ===============================
                   GLOBAL MESSAGE MODAL COLORS
                ================================*/
        /* Default (Info Blue) */
        #globalMsgModal.info .modal-header {
            background: #0d47a1 !important;
        }
        /* Success Green */
        #globalMsgModal.success .modal-header {
            background: #2e7d32 !important;
        }
        /* Error Red */
        #globalMsgModal.error .modal-header {
            background: #c62828 !important;
        }
        /* Warning Orange */
        #globalMsgModal.warning .modal-header {
            background: #ef6c00 !important;
        }

        .global-loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.45);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 999999;
        }

        .global-loader {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #1f3c73; /* your theme color */
            border-radius: 50%;
            width: 55px;
            height: 55px;
            animation: spin 1s linear infinite;
        }

        .global-loader-text {
            color: white;
            margin-top: 12px;
            font-size: 16px;
            font-weight: 600;
        }

        @@keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
        /* Common OK button style (universal professional color) */
        #globalMsgOkBtn {
            background-color: #495057 !important; /* neutral slate */
            border-color: #495057 !important;
            color: white !important;
            padding: 6px 25px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
        }

            #globalMsgOkBtn:hover {
                background-color: #343a40 !important; /* darker hover */
                border-color: #343a40 !important;
            }
    </style>
</head>
<body>
    <div id="loader-wrapper">
        <div id="loader"></div>
        <div class="loader-section section-left"></div>
        <div class="loader-section section-right"></div>
    </div>
    <div id="loader2" class="loader-overlay2" style="display:none;">
        <div class="spinner2"></div>
    </div>
    <input type="hidden" id="WebImagesUrl" value="@(Context.Session.GetString("WebImagesUrl") != null ? Context.Session.GetString("WebImagesUrl") : "")" />
    <input type="hidden" id="UserId" value="@(Context.Session.GetString("UserId") != null ? Context.Session.GetString("UserId") : "")" />
    <input type="hidden" id="StoreCodeInUse" value="@(Context.Session.GetString("StoreCodeInUse") != null ? Context.Session.GetString("StoreCodeInUse") : "")" />
    <div class="printNormalHtml"></div>
    <div class="container-fluid main-content">
        <div class="row">
            <div class="col-lg-12">
                <div class="leftMenuBar">
                    @await Component.InvokeAsync("Menu")
                </div>
                <div class="rightContentBar">
                    <div class="show_hide_leftbar">
                        <span class="hide_leftbar" title="Hide Menu"><</span>
                        <div class="show_leftbar" title="Show Menu">
                            <div></div>
                            <div></div>
                            <div></div>
                        </div>
                    </div>
                    <div class="row toprow d-none">
                        <div class="white-box col-sm-12 p-10 mt-10">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="page-title text-center">
                                        <h1 class="form-h1 mt-5px">@ViewBag.Title</h1>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    @RenderBody()
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <div class="row">
            <div class="col-sm-2"></div>
            <div class="col-sm-8">
                <p class="text-center">Copyright &copy; 2026 Ishal Inc. All Rights Reserved. </p>
            </div>
            <div class="col-sm-2">
                <p>Version: @version</p>
            </div>
        </div>
    </div>
    <div class="modal fade" id="selectCustomerAccModal" tabindex="-1" aria-labelledby="selectCustomerAccModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="selectCustomerAccModalLabel">Select Customer </h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeModal" data-modal-id="selectCustomerAccModal" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                    <form id="userSearchForm">
                        <input type="text" id="fname" name="fname" placeholder="First Name" />
                        <input type="text" id="lname" name="lname" placeholder="Last Name" />
                        <input type="text" id="state" name="state" placeholder="State" />
                        <input type="text" id="city" name="city" placeholder="City" />
                        <input type="text" id="zip" name="zip" placeholder="Zip" />
                        <input type="text" id="phone" name="phone" placeholder="Phone" />
                        <input type="text" id="email" name="email" placeholder="Email" />
                        <input type="hidden" id="userAccount" name="userAccount" value="acc" />
                        <button type="button" class="formsGlobalUniqueBtn" onclick="searchUsers()">Search</button>
                    </form>
                    <div id="searchResultsForCustomerCodes"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeModal" data-modal-id="selectCustomerAccModal" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="selectInvoiceModal" tabindex="-1" aria-labelledby="selectInvoiceModalLabel" aria-hidden="true" style="position: absolute; overflow-y: scroll;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="selectInvoiceModalLabel">Search For Invoice </h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeInvoiceModal" data-modal-id="selectInvoiceModalLabel" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="row">
                                <label class="col-sm-4">
                                    Invoice From
                                </label>
                                <div class="col-sm-8">
                                    <input type="date" id="txtFromDate" class="form-control activateFormRefreshBtn" style="font-size:13px;" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <label class="col-sm-4">
                                    To Date
                                </label>
                                <div class="col-sm-8">
                                    <input type="date" id="txtToDate" class="form-control activateFormRefreshBtn" style="font-size:13px;" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 text-right">
                            <div class="mt-5px">
                                <input type="checkbox" id="cbFillFromToDates" checked /> <span>All Dates</span>
                                <input type="button" value="Last Month" class="formsGlobalUniqueBtn btnGetLastMonthDates" />
                                <input type="button" value="Last Week" class="formsGlobalUniqueBtn btnGetLastWeekDates" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-4">
                                    Customer
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="cCode" name="cCode" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-5 text-right">
                                    First Name
                                </label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control" id="fName" name="fName" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-5 text-right">
                                    Last Name
                                </label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control" id="lName" name="lName" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-4 text-right">
                                    Address
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="address" name="address" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-4 text-right">
                                    Tel
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="tel" name="tel" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-4 text-right">
                                    State
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="state" name="state" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-4 text-right">
                                    Zip
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="zip" name="zip" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-5 text-right">
                                    Store
                                </label>
                                <div class="col-sm-7">
                                    <select id="store" name="store" class="form-control">
                                        @{
                                            if (ViewBag.StoreData != null)
                                            {
                                                foreach (var store in ViewBag.StoreData)
                                                {
                                                    <option value="@store.Value">@store.Text</option>
                                                }
                                            }
                                        }
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-7 text-right">
                                    Total From
                                </label>
                                <div class="col-sm-5">
                                    <input type="number" class="form-control" id="tFrom" name="tFrom" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-7 text-right">
                                    Total To
                                </label>
                                <div class="col-sm-5">
                                    <input type="number" class="form-control" id="tTo" name="tTo" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">
                            <div id="showReturned" style="display:none;">
                                <input type="checkbox" name="itemsNotPreviouslyReturned" id="itemsNotPreviouslyReturned" checked="checked" />
                                Items Not Previously Returned
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div id="">
                                <input type="checkbox" name="IncludeRegular" id="IncludeRegular" checked="checked" />
                                Include Regular
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div id="">
                                <input type="checkbox" name="IncludeRepair" id="IncludeRepair" checked="checked" />
                                Include Repair
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div id="">
                                <input type="checkbox" name="IncludeSpecial" id="IncludeSpecial" checked="checked" />
                                Include Special
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div id="">
                                <input type="checkbox" name="IncludeLayaway" id="IncludeLayaway" checked="checked" />
                                Include Layaway
                            </div>
                        </div>
                        <div class="col-md-2 text-right">
                            <button type="button" class="formsGlobalUniqueBtn" onclick="searchInvoice()">Search</button>
                        </div>
                        <div class="col-md-12 text-right">
                            <button type="button" class="formsGlobalUniqueBtn" onclick="updateInvoice()">Update the Invoice</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            &nbsp;
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div id="searchResultsForInvoiceCodes"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeInvoiceModal" data-modal-id="selectInvoiceModalLabel" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="selectRepairModal" tabindex="-1" aria-labelledby="selectRepairModalLabel" aria-hidden="true" style="position: absolute; overflow-y: scroll;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="selectRepairModalLabel">Search Repair Order</h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeRepairModal" data-modal-id="selectRepairModalLabel" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="row">
                                <label class="col-sm-4">
                                    From
                                </label>
                                <div class="col-sm-8">
                                    <input type="date" id="txtFromDate_repair" class="form-control activateFormRefreshBtn" style="font-size:13px;" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <label class="col-sm-4">
                                    To Date
                                </label>
                                <div class="col-sm-8">
                                    <input type="date" id="txtToDate_repair" class="form-control activateFormRefreshBtn" style="font-size:13px;" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 text-right">
                            <div class="mt-5px">
                                <input type="checkbox" id="cbFillFromToDates_repair" checked /> <span>All Dates</span>
                                <input type="button" value="Last Month" class="formsGlobalUniqueBtn btnGetLastMonthDates_repair" />
                                <input type="button" value="Last Week" class="formsGlobalUniqueBtn btnGetLastWeekDates_repair" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-4">
                                    Customer
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="cCode_repair" name="cCode" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-5 text-right">
                                    Salesrep
                                </label>
                                <div class="col-sm-7">
                                    <select id="txtSalesman1_repair" name="txtSalesman1_repair" class="form-control">
                                        @{
                                            if (ViewBag.SalesmanData != null)
                                            {
                                                foreach (var salesman in ViewBag.SalesmanData)
                                                {
                                                    <option value="@salesman.Value">@salesman.Text</option>
                                                }
                                            }
                                        }
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-5 text-right">
                                    Store
                                </label>
                                <div class="col-sm-7">
                                    <select id="ddlStore_repair" name="ddlStore_repair" class="form-control">
                                        @{
                                            if (ViewBag.StoreData != null)
                                            {
                                                foreach (var store in ViewBag.StoreData)
                                                {
                                                    <option value="@store.Value">@store.Text</option>
                                                }
                                            }
                                        }
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-5 text-right">
                                    Status
                                </label>
                                <div class="col-sm-7">
                                    <select id="ddlStatus_repair" name="ddlStatus_repair" class="form-control">
                                        <option value="">All</option>
                                        <option value="Approved">Approved</option>
                                        <option value="Customer Declined">Customer Declined</option>
                                        <option value="Estimate Only">Estimate Only</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <input type="radio" name="byDate" id="rdoByDate_repair" checked="checked" />
                            By Date
                            &nbsp;
                            <input type="radio" name="byDate" id="rdoDueDate_repair" />
                            By Due Date
                        </div>
                        <div class="col-md-2">
                            <input type="checkbox" name="openOrdersOnly" id="openOrdersOnly_repair" checked="checked" />
                            Open orders only
                        </div>
                        <div class="col-md-5">
                            <input type="radio" name="pickedType" id="rdoPicked_repair" />
                            Picked
                            &nbsp;
                            <input type="radio" name="pickedType" id="rdoPickedNot_repair" />
                            Not Picked
                            &nbsp;
                            <input type="radio" name="pickedType" id="rdoPickedAll_repair" checked="checked" />
                            All
                        </div>
                        <div class="col-md-2 text-right">
                            <button type="button" class="formsGlobalUniqueBtn" onclick="searchRepairs()">Search</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            &nbsp;
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div id="searchResultsForRepairOrders"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeRepairModal" data-modal-id="selectRepairModalLabel" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="selectProformaInvoiceModal" tabindex="-1" aria-labelledby="selectProformaInvoiceModalLabel" aria-hidden="true" style="position: absolute; overflow-y: scroll;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="selectProformaInvoiceModalLabel">Search Proforma Invoice </h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeProformaInvoiceModal" data-modal-id="selectProformaInvoiceModalLabel" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="row">
                                <label class="col-sm-4">
                                    Invoice From
                                </label>
                                <div class="col-sm-8">
                                    <input type="date" id="txtFromDate_proforma" class="form-control activateFormRefreshBtn" style="font-size:13px;" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="row">
                                <label class="col-sm-4">
                                    To Date
                                </label>
                                <div class="col-sm-8">
                                    <input type="date" id="txtToDate_proforma" class="form-control activateFormRefreshBtn" style="font-size:13px;" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 text-right">
                            <div class="mt-5px">
                                <input type="checkbox" id="cbFillFromToDates_proforma" checked /> <span>All Dates</span>
                                <input type="button" value="Last Month" class="formsGlobalUniqueBtn btnGetLastMonthDates_proforma" />
                                <input type="button" value="Last Week" class="formsGlobalUniqueBtn btnGetLastWeekDates_proforma" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-4">
                                    Customer
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="cCode" name="cCode" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-5 text-right">
                                    Name
                                </label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control" id="fName" name="fName" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-4 text-right">
                                    Tel
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="tel" name="tel" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-4 text-right">
                                    Address
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="address" name="address" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-4 text-right">
                                    State
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="state" name="state" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-4 text-right">
                                    Zip
                                </label>
                                <div class="col-sm-8">
                                    <input type="text" class="form-control" id="zip" name="zip" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-5 text-right">
                                    Store
                                </label>
                                <div class="col-sm-7">
                                    <select id="store" name="store" class="form-control">
                                        @{
                                            if (ViewBag.StoreData != null)
                                            {
                                                foreach (var store in ViewBag.StoreData)
                                                {
                                                    <option value="@store.Value">@store.Text</option>
                                                }
                                            }
                                        }
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-7 text-right">
                                    Total From
                                </label>
                                <div class="col-sm-5">
                                    <input type="number" class="form-control" id="tFrom" name="tFrom" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="row">
                                <label class="col-sm-7 text-right">
                                    Total To
                                </label>
                                <div class="col-sm-5">
                                    <input type="number" class="form-control" id="tTo" name="tTo" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <div id="showReturned" style="display:none;">
                                <input type="checkbox" name="itemsNotPreviouslyReturned" id="itemsNotPreviouslyReturned" checked="checked" />
                                Items Not Previously Returned
                            </div>
                        </div>
                        <div class="col-md-4 text-right">
                            <button type="button" class="formsGlobalUniqueBtn" onclick="searchProformaInvoice()">Search</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            &nbsp;
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div id="searchResultsForProformaInvoiceCodes"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeProformaInvoiceModal" data-modal-id="selectProformaInvoiceModalLabel" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="selectPOModal" tabindex="-1" aria-labelledby="selectPOModalLabel" aria-hidden="true" style="position: absolute; overflow-y: scroll;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id=""> </h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closePOModal" data-modal-id="selectPOModalLabel" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-5">
                                    Cust Code
                                </label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control" id="cCode_pon" name="cCode" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-5">
                                    From Date
                                </label>
                                <div class="col-sm-7">
                                    <input type="date" id="txtFromDate_pon" class="form-control activateFormRefreshBtn" style="font-size:13px;" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="row">
                                <label class="col-sm-5">
                                    To Date
                                </label>
                                <div class="col-sm-7">
                                    <input type="date" id="txtToDate_pon" class="form-control activateFormRefreshBtn" style="font-size:13px;" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <input type="checkbox" id="cbFillFromToDates_pon" checked /> <span>All Dates</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 text-right">
                            <button type="button" class="formsGlobalUniqueBtn" onclick="searchPO()">Search</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            &nbsp;
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div id="searchResultsForPO"></div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closePOModal" data-modal-id="selectPOModalLabel" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="firstCommonBsModal" tabindex="-1" aria-labelledby="firstCommonBsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="firstCommonBsModalLabel"></h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeModal" data-modal-id="firstCommonBsModal" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeModal" data-modal-id="firstCommonBsModal" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="secondCommonBsModal" tabindex="-1" aria-labelledby="secondCommonBsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="secondCommonBsModalLabel"></h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeModal" data-modal-id="secondCommonBsModal" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeModal" data-modal-id="secondCommonBsModal" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="selectAppraisalCodeModal" tabindex="-1" aria-labelledby="selectAppraisalCodeModalLabel" aria-hidden="true" style="overflow-y: auto;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="selectAppraisalCodeModalLabel">Appraisal Details </h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeModal" data-modal-id="selectAppraisalCodeModal" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                    <div id="searchResultsForAppraisalCode"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeModal" data-modal-id="selectAppraisalCodeModal" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    @*<script src="~/js/admin.js"></script>*@
    <script src="~/js/jquery.js"></script>
    <script src="~/js/jquery-ui.min.js"></script>
    <script src="~/js/bootstrap.min.js"></script>
    <script src="~/js/owl.carousel.min.js"></script>
    <script src="~/js/custom.js"></script>
    <script src="~/js/custom-new.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    @*<link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css" />*@
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.2.2/css/buttons.dataTables.min.css" />
    @*<script type="text/javascript" src="https://code.jquery.com/jquery-1.12.3.js"></script>*@
    @*<script type="text/javascript" src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>*@
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.2.2/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.2.2/js/buttons.html5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.14/jspdf.plugin.autotable.min.js"></script>
    @* <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>*@
    <script type="text/javascript" src="~/js/bootstrap-typeahead.js"></script>
    <!-- Required Libraries -->
    @*<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" />*@
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    @*<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>*@
    <script>
        $(document).ready(function () {
            $(".show_leftbar").click(function () {
                $(".leftMenuBar").show();
                //$(".rightContentBar").css({ "width": "calc(100% - 275px)", "padding": "0px 30px 20px !important" });
                $(".show_leftbar").hide();
                $(".hide_leftbar").show();
            })
            $(".hide_leftbar").click(function () {
                $(".leftMenuBar").hide();
                $(".rightContentBar").css({ "width": "100%", "padding": "0px 50px !important" });
                $(".show_leftbar").show();
                $(".hide_leftbar").hide();
            })
            $(".dropdown-toggle").click(function () {
                $(".dropdown-menu").not($(this).siblings(".dropdown-menu")).slideUp();
                $(this).siblings(".dropdown-menu").slideToggle();
            })
            $(".dropdown-item").click(function () {
                //$(".dropdown-menu.third_ul").hide();
                $(".dropdown-menu.third_ul").not($(this).siblings(".dropdown-menu")).hide();
                //$(".dropdown-menu.third_ul").css({ left: $(this).offset().left * -1 });
                $(".dropdown-menu.third_ul").css({ left: 0 })
                $(this).siblings(".dropdown-menu").slideToggle();
            })
            $('a.dropdown-item').each(function () {
                var hrefValue = $(this).attr('href');
                // If href is not '/', show the parent elements
                if (hrefValue !== '/#' && hrefValue !== '/' && typeof $(this).attr('href') !== 'undefined') {
                    //alert(hrefValue);
                    $(this).closest('.default_ul').removeClass('hidden');
                    $(this).closest('.default_li').removeClass('hidden');
                    $(this).closest('.first_ul').removeClass('hidden');
                    $(this).closest('.first_li').removeClass('hidden');
                    $(this).closest('.second_ul').removeClass('hidden');
                    $(this).closest('.second_li').removeClass('hidden');
                    $(this).closest('.third_ul').removeClass('hidden');
                    $(this).closest('.third_li').removeClass('hidden');
                }
            });
            const suggestions = [
                "Add a Quote",
                "Edit a Quote",
                "Delete a Quote",
                "List Of Quotes",
                "Quick CRM"
            ];
            // Expand search input on click
            $(".search-icon").click(function () {
                $(".search-input").addClass("expanded").focus();
            });
            // Auto-suggest functionality
            $(".search-input").on("input", function () {
                const query = $(this).val().toLowerCase();
                const filteredSuggestions = suggestions.filter((item) =>
                    item.toLowerCase().includes(query)
                );
                const suggestionsList = $(".suggestions");
                suggestionsList.empty();
                if (query && filteredSuggestions.length) {
                    filteredSuggestions.forEach((item) => {
                        suggestionsList.append(`<li>${item}</li>`);
                    });
                    suggestionsList.show();
                } else {
                    suggestionsList.hide();
                }
            });
            // Populate search input on clicking suggestion
            $(".suggestions").on("click", "li", function () {
                $(".search-input").val($(this).text());
                $(".suggestions").hide();
            });
            // Close suggestions when clicking outside
            $(document).click(function (e) {
                if (!$(e.target).closest(".search-container").length) {
                    $(".search-input").removeClass("expanded");
                    $(".suggestions").hide();
                }
            });
            $('.dropdown-menu.third_ul').each(function () {
                const count = $(this).find('.inneritemsdiv').length;
                if (count == 1) {
                    $(this).addClass('one_column');
                }
                if (count == 2) {
                    $(this).addClass('two_columns');
                }
                if (count == 3) {
                    $(this).addClass('three_columns');
                }
            });
            $(document).on('click', '.default_li', function () {
                $(".default_li").removeClass('active');
                $(".second_anchor").removeClass('active');
                $(this).addClass('active');
            })
            $(document).on('click', '.second_anchor', function () {
                $(".second_anchor").removeClass('active');
                $(this).addClass('active');
                return false;
            })
        });
    </script>
    <div class="printableContent"></div>
    <div class="modal fade" id="previewContentModal" tabindex="-1" aria-labelledby="previewContentModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-center" id="previewContentModalLabel"></h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeModal" data-modal-id="previewContentModal" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                    <div class="previewContent"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeModal" data-modal-id="previewContentModal" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="searchContentModal" tabindex="-1" aria-labelledby="searchContentModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-center" id="searchContentModalLabel"></h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeModal searchCloseButton" data-modal-id="searchContentModal" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                    <div class="searchContent"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeModal searchCloseButton" data-modal-id="searchContentModal" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="errorMsgModal" tabindex="-1" aria-labelledby="errorMsgModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-center" id="errorMsgModalLabel"></h5>
                    <button type="button" class="formsGlobalUniqueCloseBtn btn-close closeModal searchCloseButton" data-modal-id="searchContentModal" data-bs-dismiss="modal" aria-label="Close">X</button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-sm-1" style="padding:20px;"><i class="fa fa-exclamation-triangle" style="color:#f00;font-size:25px;"></i> </div>
                        <div class="col-sm-11"><span class="errorMsg"></span></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="formsGlobalUniqueCloseBtn closeModal errorMsgCloseButton" data-modal-id="errorMsgModal" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="globalMsgModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header msgbox-header">
                    <h5 class="modal-title" id="globalMsgTitle">Info</h5>
                    <button type="button" class="close msgbox-close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body" id="globalMsgBody"></div>
                <div class="modal-footer text-center">
                    @*<button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>*@
                    <button id="globalMsgOkBtn" type="button" class="btn" data-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="salesChartModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
            <div class="modal-content">

                <div class="modal-header py-2 px-3 bg-primary text-white">
                    <h6 class="modal-title mb-0">
                        <i class="fa fa-line-chart me-1"></i>
                        Sales Comparison Graph
                    </h6>
                    <button type="button" class="btn-close btn-close-white" data-dismiss="modal"></button>
                </div>

                <div class="modal-body" style="max-height:70vh; overflow-y:auto;">

                    @*<h6 class="text-center fw-bold">NET SALES</h6>*@
                    <canvas id="netSalesChart" height="180"></canvas>
                    <hr class="my-2" />
                    <canvas id="paymentsChart" height="180"></canvas>

                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-danger" data-dismiss="modal">
                        <i class="fa fa-times me-1"></i> Close
                    </button>
                </div>


            </div>
        </div>
    </div>
    <!-- Include this script just before the closing </body> tag -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
    <script>
        window.onerror = function (message, source, lineno, colno, error) {
            // When an error happens, take a screenshot of the page
            html2canvas(document.body).then(function (canvas) {
                // Convert the canvas to a data URL
                var imgData = canvas.toDataURL('image/png');
                // Send the screenshot to the server using AJAX
                var xhr = new XMLHttpRequest();
                xhr.open('POST', '/Error/SaveScreenshot', true);
                xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        console.log('Screenshot sent successfully');
                    }
                };
                xhr.send(JSON.stringify({ screenshot: imgData }));
            });
        };
        function ShowMsg(message, title = "Info") {
            $("#globalMsgTitle").text(title);
            $("#globalMsgBody").html(message);
            $("#globalMsgModal").modal("show");
        }
    </script>
    <script src="~/js/scanAccordion.js"></script>
    @RenderSection("scripts", required: false)
    <script>
        function ShowMsg(message, title) {
            if (!title) title = "Info"; // default
            // remove old state
            $("#globalMsgModal")
                .removeClass("info success error warning");
            // apply new state class
            let cls = title.toLowerCase(); // "success", "error", "info", ...
            $("#globalMsgModal").addClass(cls);
            // show message
            $("#globalMsgTitle").text(title);
            $("#globalMsgBody").html(message);
            $("#globalMsgModal").modal("show");
        }
        function ShowLoader() {
            $("#globalLoader").fadeIn(150);
        }
        function HideLoader() {
            $("#globalLoader").fadeOut(150);
        }
        // OK button click handler
        $(document).on("click", "#globalMsgOkBtn", function () {
            let title = $("#globalMsgTitle").text().trim();
            // Redirect only for success messages
            if (title.toLowerCase() === "success") {
                setTimeout(function () {
                    window.location.href = '@Url.Action("Index", "Home")';
                }, 300); // delay for modal close animation
            }
        });
    </script>
    <div id="globalLoader" class="global-loader-overlay" style="display:none;">
        <div class="global-loader"></div>
        <div class="global-loader-text">Processing...</div>
    </div>
</body>
</html>